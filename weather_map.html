<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Weather Map</title>

    <script src='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.css' rel='stylesheet' />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

</head>
<body>

    <!--Nav Header-->
    <nav class="navbar bg-primary">
        <a class="navbar-brand text-white" href="#">Weather App</a>
        <span class="navbar-text text-white currentCity">Current City: San Antonio</span>
    </nav>

    <!--Search for Place-->
    <form>
        <label for="city">Place</label>
        <input type="text" id="city" name="city">
        <input type="submit" value="Submit">
    </form>

    <!--Weather Conditions-->
    <div class="card-group">
        <div class="card" id="card1"></div>
        <div class="card" id="card2"></div>
        <div class="card" id="card3"></div>
        <div class="card" id="card4"></div>
        <div class="card" id="card5"></div>
    </div>

    <!--Map-->
    <div id='map' style='width: 100vw; height: 90vh;'></div>



<script src="./js/jquery.js"></script>
<script src="./js/keys.js"></script>
<script src="./js/mapbox-geocoder-utils.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>

<!--Start of JS-->
<script>
  "use strict"

  $(document).ready(function (){

    //generate information
      //https://api.openweathermap.org/data/2.5/onecall?
    $.get(`https://api.openweathermap.org/data/2.5/onecall`,{
      appid: openWeatherAPIkey,
      lat: 29.424349,
        lon: -98.491142,
        units: "imperial"
    }).done(function(data){
       weatherInfo(data);
       //displayCity(data);
        console.log(data);
        tester(data, 0);
      });

    //generate map
      mapboxgl.accessToken = mapboxAPIkey;
      var map = new mapboxgl.Map({
          container: 'map',
          style: 'mapbox://styles/mapbox/streets-v9',
          zoom: 10,
          center: [-98.4916, 29.4252]
      });

      // //display weather info in HTML
      function weatherInfo(data){
          let filler1 = "<p>Temperature: "+ data.current.temp + "</p><p>Description: " + data.current.weather[0].description + "</p><p>Humidity: " + data.current.humidity +
              "</p><p>Wind: " + data.current.wind_gust + "</p><p>Pressure: " +  data.current.pressure+"</p>";
          $("#card1").html(filler1);

          let filler2 = "<p>Temperature: "+ data.daily[0].temp.day + "</p><p>Description: " + data.daily[0].weather[0].description + "</p><p>Humidity: " + data.daily[0].humidity +
              "</p><p>Wind: " + data.daily[0].wind_gust + "</p><p>Pressure: " +  data.daily[0].pressure+"</p>";
          $("#card2").html(filler2);

          let filler3 = "<p>Temperature: "+ data.daily[1].temp.day + "</p><p>Description: " + data.daily[1].weather[0].description + "</p><p>Humidity: " + data.daily[1].humidity +
              "</p><p>Wind: " + data.daily[1].wind_gust + "</p><p>Pressure: " +  data.daily[1].pressure+"</p>";
          $("#card3").html(filler3);

          let filler4 = "<p>Temperature: "+ data.daily[2].temp.day + "</p><p>Description: " + data.daily[2].weather[0].description + "</p><p>Humidity: " + data.daily[2].humidity +
              "</p><p>Wind: " + data.daily[2].wind_gust + "</p><p>Pressure: " +  data.daily[2].pressure+"</p>";
          $("#card4").html(filler4);

          let filler5 = "<p>Temperature: "+ data.daily[3].temp.day + "</p><p>Description: " + data.daily[3].weather[0].description + "</p><p>Humidity: " + data.daily[3].humidity +
              "</p><p>Wind: " + data.daily[3].wind_gust + "</p><p>Pressure: " +  data.daily[3].pressure+"</p>";
          $("#card5").html(filler5);
      }

      // //gets daily forecast
      function tester(data){
          data.daily.forEach(function(day, index){
              if(index < 5){
                  console.log(day)
                  console.log(index);
              };
          })
      }


      //Upon click to search for new city, update


      // Geocode to take user input and recenter map to where they type in
      // geocode("Cambridge, MA 02138", mapboxAPIkey).then(function(result) {
      //     console.log("dumbby dumb dumb");
      //     console.log(result);
      // });


      //display current city
      // function displayCity(data){
      //     $(".currentCity").html("Current City: " + data.name);
      // }

  //last closing bracket
  });


</script>
</body>
</html>